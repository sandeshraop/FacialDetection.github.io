# Optimized Configuration for State-of-the-Art Micro-Expression Recognition

model:
  architecture: hybrid_attention
  num_classes: 4
  input_size: 224
  num_rois: 3
  roi_channels: 3
  temporal_windows: 4
  dropout: 0.3
  hidden_dim: 256
  attention_heads: 8

augmentation:
  horizontal_flip: true
  gaussian_noise: true
  noise_std: 0.01
  temporal_dropout: true
  temporal_dropout_rate: 0.1
  roi_augmentation: true

data:
  data_dir: data/processed/roi_optical_flow
  batch_size: 16
  num_workers: 4
  random_seed: 42
  persistent_workers: false
  pin_memory: true
  normalize_roi: true

training:
  num_epochs: 40
  lr: 0.0003
  weight_decay: 0.00005
  early_stop: 10
  mixed_precision: true
  gradient_clip: 1.0
  warmup_epochs: 2
  accumulation_steps: 1
  ema_decay: 0.999

scheduler:
  type: cosine
  T_max: 40
  eta_min: 1e-6
  warmup_steps: 100

loss:
  type: focal
  gamma: 2.0
  alpha: 0.25
  class_weights: true
  label_smoothing: 0.1

validation:
  val_split: 0.1
  val_frequency: 1
  save_best_only: true
  monitor: val_uar
